{
  "version": "tree-0.1",
  "tree": {
    "id": "App",
    "path": "",
    "children": {
      "example-pets": {
        "id": "example-pets",
        "path": "example-pets",
        "children": {
          "pets": {
            "id": "pets",
            "path": "example-pets/pets",
            "children": {
              "event-store": {
                "id": "event-store",
                "path": "example-pets/pets/event-store",
                "children": {
                  "event-store": {
                    "id": "event-store",
                    "path": "example-pets/pets/event-store/event-store",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/event-store/event-store/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::DynamoDB::Table",
                          "aws:cdk:cloudformation:props": {
                            "attributeDefinitions": [
                              {
                                "attributeName": "id",
                                "attributeType": "S"
                              }
                            ],
                            "keySchema": [
                              {
                                "attributeName": "id",
                                "keyType": "HASH"
                              }
                            ],
                            "provisionedThroughput": {
                              "readCapacityUnits": 5,
                              "writeCapacityUnits": 5
                            },
                            "streamSpecification": {
                              "streamViewType": "NEW_IMAGE"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_dynamodb.CfnTable",
                          "version": "2.90.0"
                        }
                      },
                      "ScalingRole": {
                        "id": "ScalingRole",
                        "path": "example-pets/pets/event-store/event-store/ScalingRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_dynamodb.Table",
                      "version": "2.90.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.2.69"
                }
              },
              "domain-event-bus": {
                "id": "domain-event-bus",
                "path": "example-pets/pets/domain-event-bus",
                "children": {
                  "event-bus": {
                    "id": "event-bus",
                    "path": "example-pets/pets/domain-event-bus/event-bus",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/domain-event-bus/event-bus/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::Events::EventBus",
                          "aws:cdk:cloudformation:props": {
                            "name": "pets"
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_events.CfnEventBus",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_events.EventBus",
                      "version": "2.90.0"
                    }
                  },
                  "PipeRole": {
                    "id": "PipeRole",
                    "path": "example-pets/pets/domain-event-bus/PipeRole",
                    "children": {
                      "ImportPipeRole": {
                        "id": "ImportPipeRole",
                        "path": "example-pets/pets/domain-event-bus/PipeRole/ImportPipeRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.90.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/domain-event-bus/PipeRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "pipes.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "policies": [
                              {
                                "policyName": "sourcePolicy",
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": [
                                        "dynamodb:DescribeStream",
                                        "dynamodb:GetRecords",
                                        "dynamodb:GetShardIterator",
                                        "dynamodb:ListStreams"
                                      ],
                                      "Effect": "Allow",
                                      "Resource": {
                                        "Fn::GetAtt": [
                                          "petseventstore81DA8DE9",
                                          "StreamArn"
                                        ]
                                      }
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                }
                              },
                              {
                                "policyName": "targetPolicy",
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": "events:PutEvents",
                                      "Effect": "Allow",
                                      "Resource": {
                                        "Fn::GetAtt": [
                                          "petsdomaineventbus4C3E1981",
                                          "Arn"
                                        ]
                                      }
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                }
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.90.0"
                    }
                  },
                  "pipe": {
                    "id": "pipe",
                    "path": "example-pets/pets/domain-event-bus/pipe",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::Pipes::Pipe",
                      "aws:cdk:cloudformation:props": {
                        "name": "SampleTableModifyPipe",
                        "roleArn": {
                          "Fn::GetAtt": [
                            "petsdomaineventbusPipeRole6F932D1F",
                            "Arn"
                          ]
                        },
                        "source": {
                          "Fn::GetAtt": [
                            "petseventstore81DA8DE9",
                            "StreamArn"
                          ]
                        },
                        "sourceParameters": {
                          "dynamoDbStreamParameters": {
                            "startingPosition": "LATEST",
                            "batchSize": 1
                          }
                        },
                        "target": {
                          "Fn::GetAtt": [
                            "petsdomaineventbus4C3E1981",
                            "Arn"
                          ]
                        },
                        "targetParameters": {
                          "eventBridgeEventBusParameters": {
                            "detailType": "SampleTableModified",
                            "source": "com.sample"
                          }
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_pipes.CfnPipe",
                      "version": "2.90.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.2.69"
                }
              },
              "public-rest-gateway": {
                "id": "public-rest-gateway",
                "path": "example-pets/pets/public-rest-gateway",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_apigateway.RestApiBase",
                  "version": "2.90.0"
                }
              },
              "public-rest-gateway-root-resource": {
                "id": "public-rest-gateway-root-resource",
                "path": "example-pets/pets/public-rest-gateway-root-resource",
                "children": {
                  "pets": {
                    "id": "pets",
                    "path": "example-pets/pets/public-rest-gateway-root-resource/pets",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/public-rest-gateway-root-resource/pets/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::ApiGateway::Resource",
                          "aws:cdk:cloudformation:props": {
                            "parentId": "zu9qs4uwok",
                            "pathPart": "pets",
                            "restApiId": "9wejt4xyxa"
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_apigateway.CfnResource",
                          "version": "2.90.0"
                        }
                      },
                      "PUT": {
                        "id": "PUT",
                        "path": "example-pets/pets/public-rest-gateway-root-resource/pets/PUT",
                        "children": {
                          "Resource": {
                            "id": "Resource",
                            "path": "example-pets/pets/public-rest-gateway-root-resource/pets/PUT/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::ApiGateway::Method",
                              "aws:cdk:cloudformation:props": {
                                "authorizationType": "NONE",
                                "httpMethod": "PUT",
                                "integration": {
                                  "type": "AWS",
                                  "uri": {
                                    "Fn::Join": [
                                      "",
                                      [
                                        "arn:",
                                        {
                                          "Ref": "AWS::Partition"
                                        },
                                        ":apigateway:eu-central-1:dynamodb:action/PutItem"
                                      ]
                                    ]
                                  },
                                  "integrationHttpMethod": "POST",
                                  "requestTemplates": {
                                    "application/json": {
                                      "Fn::Join": [
                                        "",
                                        [
                                          "{\n              \"Item\": {\n                \"id\": {\n                  \"S\": \"$context.requestId\"\n                },\n                \"Name\": {\n                  \"S\": \"$input.path('$.name')\"\n                },\n                \"Color\": {\n                  \"S\": \"$input.path('$.color')\"\n                }\n              },\n              \"TableName\": \"",
                                          {
                                            "Ref": "petseventstore81DA8DE9"
                                          },
                                          "\"\n            }"
                                        ]
                                      ]
                                    }
                                  },
                                  "integrationResponses": [
                                    {
                                      "statusCode": "202",
                                      "responseTemplates": {
                                        "application/json": "{\n                \"requestId\": \"$context.requestId\"\n              }"
                                      }
                                    }
                                  ],
                                  "credentials": {
                                    "Fn::GetAtt": [
                                      "petseventstoreintegrationputEventRoleB3FE91FB",
                                      "Arn"
                                    ]
                                  }
                                },
                                "methodResponses": [
                                  {
                                    "statusCode": "202"
                                  }
                                ],
                                "resourceId": {
                                  "Ref": "petspublicrestgatewayrootresourcepets31A0AEB9"
                                },
                                "restApiId": "9wejt4xyxa"
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_apigateway.CfnMethod",
                              "version": "2.90.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_apigateway.Method",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_apigateway.Resource",
                      "version": "2.90.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_apigateway.ResourceBase",
                  "version": "2.90.0"
                }
              },
              "event-store-integration": {
                "id": "event-store-integration",
                "path": "example-pets/pets/event-store-integration",
                "children": {
                  "putEventPolicy": {
                    "id": "putEventPolicy",
                    "path": "example-pets/pets/event-store-integration/putEventPolicy",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/event-store-integration/putEventPolicy/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                          "aws:cdk:cloudformation:props": {
                            "policyDocument": {
                              "Statement": [
                                {
                                  "Action": "dynamodb:PutItem",
                                  "Effect": "Allow",
                                  "Resource": {
                                    "Fn::GetAtt": [
                                      "petseventstore81DA8DE9",
                                      "Arn"
                                    ]
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "policyName": "petseventstoreintegrationputEventPolicy1B4823B4",
                            "roles": [
                              {
                                "Ref": "petseventstoreintegrationputEventRoleB3FE91FB"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Policy",
                      "version": "2.90.0"
                    }
                  },
                  "putEventRole": {
                    "id": "putEventRole",
                    "path": "example-pets/pets/event-store-integration/putEventRole",
                    "children": {
                      "ImportputEventRole": {
                        "id": "ImportputEventRole",
                        "path": "example-pets/pets/event-store-integration/putEventRole/ImportputEventRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.90.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/event-store-integration/putEventRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "apigateway.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.90.0"
                    }
                  },
                  "public-rest-gateway-deployment": {
                    "id": "public-rest-gateway-deployment",
                    "path": "example-pets/pets/event-store-integration/public-rest-gateway-deployment",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/event-store-integration/public-rest-gateway-deployment/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::ApiGateway::Deployment",
                          "aws:cdk:cloudformation:props": {
                            "description": "Fri Sep 15 2023",
                            "restApiId": "9wejt4xyxa",
                            "stageName": "prod"
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_apigateway.CfnDeployment",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_apigateway.Deployment",
                      "version": "2.90.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.2.69"
                }
              },
              "read-model": {
                "id": "read-model",
                "path": "example-pets/pets/read-model",
                "children": {
                  "read-model-table": {
                    "id": "read-model-table",
                    "path": "example-pets/pets/read-model/read-model-table",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/read-model/read-model-table/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::DynamoDB::Table",
                          "aws:cdk:cloudformation:props": {
                            "attributeDefinitions": [
                              {
                                "attributeName": "id",
                                "attributeType": "S"
                              }
                            ],
                            "keySchema": [
                              {
                                "attributeName": "id",
                                "keyType": "HASH"
                              }
                            ],
                            "provisionedThroughput": {
                              "readCapacityUnits": 5,
                              "writeCapacityUnits": 5
                            },
                            "tableName": "pets"
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_dynamodb.CfnTable",
                          "version": "2.90.0"
                        }
                      },
                      "ScalingRole": {
                        "id": "ScalingRole",
                        "path": "example-pets/pets/read-model/read-model-table/ScalingRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_dynamodb.Table",
                      "version": "2.90.0"
                    }
                  },
                  "event-listener": {
                    "id": "event-listener",
                    "path": "example-pets/pets/read-model/event-listener",
                    "children": {
                      "ServiceRole": {
                        "id": "ServiceRole",
                        "path": "example-pets/pets/read-model/event-listener/ServiceRole",
                        "children": {
                          "ImportServiceRole": {
                            "id": "ImportServiceRole",
                            "path": "example-pets/pets/read-model/event-listener/ServiceRole/ImportServiceRole",
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.Resource",
                              "version": "2.90.0"
                            }
                          },
                          "Resource": {
                            "id": "Resource",
                            "path": "example-pets/pets/read-model/event-listener/ServiceRole/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                              "aws:cdk:cloudformation:props": {
                                "assumeRolePolicyDocument": {
                                  "Statement": [
                                    {
                                      "Action": "sts:AssumeRole",
                                      "Effect": "Allow",
                                      "Principal": {
                                        "Service": "lambda.amazonaws.com"
                                      }
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                },
                                "managedPolicyArns": [
                                  {
                                    "Fn::Join": [
                                      "",
                                      [
                                        "arn:",
                                        {
                                          "Ref": "AWS::Partition"
                                        },
                                        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                                      ]
                                    ]
                                  }
                                ]
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                              "version": "2.90.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.Role",
                          "version": "2.90.0"
                        }
                      },
                      "Code": {
                        "id": "Code",
                        "path": "example-pets/pets/read-model/event-listener/Code",
                        "children": {
                          "Stage": {
                            "id": "Stage",
                            "path": "example-pets/pets/read-model/event-listener/Code/Stage",
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.AssetStaging",
                              "version": "2.90.0"
                            }
                          },
                          "AssetBucket": {
                            "id": "AssetBucket",
                            "path": "example-pets/pets/read-model/event-listener/Code/AssetBucket",
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                              "version": "2.90.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                          "version": "2.90.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/read-model/event-listener/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                          "aws:cdk:cloudformation:props": {
                            "code": {
                              "s3Bucket": "cdk-hnb659fds-assets-588476158895-eu-central-1",
                              "s3Key": "59c3d25538a2f9b6d4bbe2e5920f31c4c09ae95a5186ddf5603281f17d06d365.zip"
                            },
                            "environment": {
                              "variables": {
                                "AWS_NODEJS_CONNECTION_REUSE_ENABLED": "1"
                              }
                            },
                            "functionName": "pets-event-handler",
                            "handler": "index.handler",
                            "role": {
                              "Fn::GetAtt": [
                                "petsreadmodeleventlistenerServiceRole6AEE490E",
                                "Arn"
                              ]
                            },
                            "runtime": "nodejs18.x"
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_lambda_nodejs.NodejsFunction",
                      "version": "2.90.0"
                    }
                  },
                  "rule": {
                    "id": "rule",
                    "path": "example-pets/pets/read-model/rule",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "example-pets/pets/read-model/rule/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                          "aws:cdk:cloudformation:props": {
                            "eventBusName": {
                              "Ref": "petsdomaineventbus4C3E1981"
                            },
                            "eventPattern": {
                              "source": [
                                "com.sample"
                              ]
                            },
                            "state": "ENABLED",
                            "targets": [
                              {
                                "id": "Target0",
                                "arn": {
                                  "Fn::GetAtt": [
                                    "petsreadmodeleventlistenerAAF55874",
                                    "Arn"
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_events.CfnRule",
                          "version": "2.90.0"
                        }
                      },
                      "AllowEventRuleexamplepetsreadmodeleventlistenerC3A7E36E": {
                        "id": "AllowEventRuleexamplepetsreadmodeleventlistenerC3A7E36E",
                        "path": "example-pets/pets/read-model/rule/AllowEventRuleexamplepetsreadmodeleventlistenerC3A7E36E",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::Lambda::Permission",
                          "aws:cdk:cloudformation:props": {
                            "action": "lambda:InvokeFunction",
                            "functionName": {
                              "Fn::GetAtt": [
                                "petsreadmodeleventlistenerAAF55874",
                                "Arn"
                              ]
                            },
                            "principal": "events.amazonaws.com",
                            "sourceArn": {
                              "Fn::GetAtt": [
                                "petsreadmodelrule244915A4",
                                "Arn"
                              ]
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_lambda.CfnPermission",
                          "version": "2.90.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_events.Rule",
                      "version": "2.90.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.2.69"
                }
              }
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.2.69"
            }
          },
          "CDKMetadata": {
            "id": "CDKMetadata",
            "path": "example-pets/CDKMetadata",
            "children": {
              "Default": {
                "id": "Default",
                "path": "example-pets/CDKMetadata/Default",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.90.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.2.69"
            }
          },
          "BootstrapVersion": {
            "id": "BootstrapVersion",
            "path": "example-pets/BootstrapVersion",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.90.0"
            }
          },
          "CheckBootstrapVersion": {
            "id": "CheckBootstrapVersion",
            "path": "example-pets/CheckBootstrapVersion",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnRule",
              "version": "2.90.0"
            }
          }
        },
        "constructInfo": {
          "fqn": "aws-cdk-lib.Stack",
          "version": "2.90.0"
        }
      },
      "Tree": {
        "id": "Tree",
        "path": "Tree",
        "constructInfo": {
          "fqn": "constructs.Construct",
          "version": "10.2.69"
        }
      }
    },
    "constructInfo": {
      "fqn": "aws-cdk-lib.App",
      "version": "2.90.0"
    }
  }
}